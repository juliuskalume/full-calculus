<!DOCTYPE html>
<html class="light" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#0d59f2" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />
    <link rel="icon" type="image/png" href="icons/icon-192.png" />
    <title>Login Restriction Error</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800&display=swap"
    />
    <!-- Material Symbols -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700&display=swap"
    />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Tailwind Config -->
    <script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#0df259",
              "background-light": "#f5f8f6",
              "background-dark": "#102216",
              "text-light": "#0d1c12",
              "text-dark": "#e8f5e9",
            },
            fontFamily: {
              display: ["Lexend", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.5rem",
              lg: "1rem",
              xl: "1.5rem",
              full: "9999px",
            },
          },
        },
      };
    </script>
    <style>
      body {
        min-height: max(884px, 100dvh);
      }
    </style>
    <script src="theme.js"></script>
  </head>
  <body class="bg-background-light dark:bg-background-dark font-display antialiased transition-colors duration-200">
    <div class="relative flex h-full min-h-screen w-full flex-col overflow-hidden">
      <!-- Header -->
      <div class="flex items-center px-4 py-4 justify-between w-full max-w-lg mx-auto">
        <!-- Invisible spacer for balance -->
        <div class="w-12 h-12"></div>
        <!-- Close Button -->
        <button
          id="closeBtn"
          class="flex w-10 h-10 items-center justify-center rounded-full bg-transparent hover:bg-black/5 dark:hover:bg-white/10 transition-colors text-text-light dark:text-text-dark"
          type="button"
          aria-label="Close"
        >
          <span class="material-symbols-outlined" style="font-size: 24px">close</span>
        </button>
      </div>
      <!-- Main Content Area -->
      <div class="flex-1 flex flex-col items-center justify-center px-6 w-full max-w-md mx-auto">
        <!-- Mascot Illustration -->
        <div class="relative mb-8 group">
          <!-- Decorative Glow -->
          <div class="absolute inset-0 bg-primary/30 blur-3xl rounded-full opacity-50 scale-110 group-hover:scale-125 transition-transform duration-700"></div>
          <!-- Image Container -->
          <div
            class="relative w-48 h-48 md:w-56 md:h-56 bg-white dark:bg-[#1a3322] rounded-full flex items-center justify-center shadow-xl shadow-primary/10 overflow-hidden border-4 border-white dark:border-[#2a4532]"
          >
            <div
              class="w-full h-full bg-center bg-cover"
              data-alt="Apologetic fox mascot looking down with sad eyes"
              style='background-image: url("icons/apologetic-fox.png")'
            ></div>
          </div>
        </div>
        <!-- Text Block -->
        <div class="flex flex-col items-center gap-3 text-center mb-10 w-full">
          <h1 class="text-text-light dark:text-text-dark text-2xl md:text-3xl font-extrabold leading-tight tracking-tight">
            Sorry, we can't log you in from here.
          </h1>
          <p class="text-text-light/70 dark:text-text-dark/70 text-base md:text-lg font-normal leading-relaxed max-w-[320px]">
            Due to technical limitations specific to Firefox, please log in on your browser instead. Then restart this app.
          </p>
        </div>
        <!-- Primary Action -->
        <button
          id="openBrowserBtn"
          class="w-full cursor-pointer flex items-center justify-center gap-2 overflow-hidden rounded-xl h-14 bg-primary hover:bg-primary/90 text-[#0d1c12] text-base font-bold leading-normal tracking-[0.015em] shadow-lg shadow-primary/25 transition-all active:scale-[0.98]"
          type="button"
        >
          <span class="material-symbols-outlined" style="font-size: 20px">open_in_browser</span>
          <span>Open Browser to Log In</span>
        </button>
        <!-- Secondary Action -->
        <button
          id="backBtn"
          class="mt-4 w-full cursor-pointer flex items-center justify-center overflow-hidden rounded-xl h-12 bg-transparent text-text-light/60 dark:text-text-dark/60 hover:text-text-light dark:hover:text-text-dark text-sm font-bold leading-normal tracking-[0.015em] transition-colors"
          type="button"
        >
          Go back
        </button>
      </div>
      <!-- Bottom Spacer -->
      <div class="h-8"></div>
    </div>

    <script>
      (function () {
        const origin = window.location.origin;
        const loginUrl = origin + "/login.html";
        const openBrowserBtn = document.getElementById("openBrowserBtn");
        const backBtn = document.getElementById("backBtn");
        const closeBtn = document.getElementById("closeBtn");

        const openInFirefox = () => {
          const ua = navigator.userAgent || "";
          const isAndroid = /android/i.test(ua);
          if (isAndroid) {
            const url = new URL(loginUrl);
            const scheme = url.protocol.replace(":", "");
            const fallback = encodeURIComponent(loginUrl);
            const intentUrl = `intent://${url.host}${url.pathname}#Intent;scheme=${scheme};package=org.mozilla.firefox;S.browser_fallback_url=${fallback};end`;
            window.location.href = intentUrl;
            setTimeout(() => {
              if (document.visibilityState === "visible") {
                window.location.href = loginUrl;
              }
            }, 1200);
            return;
          }
          window.location.href = loginUrl;
        };

        const goBack = () => {
          if (window.history.length > 1) {
            window.history.back();
          } else {
            window.location.href = "index.html";
          }
        };

        openBrowserBtn?.addEventListener("click", openInFirefox);
        backBtn?.addEventListener("click", goBack);
        closeBtn?.addEventListener("click", goBack);
      })();
    </script>
  </body>
</html>
